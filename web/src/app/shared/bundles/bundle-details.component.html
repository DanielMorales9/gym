<div class="card-container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>{{bundle?.name || 'Loading...'}}</mat-card-title>
            <mat-card-subtitle>{{bundle?.bundleSpec.description || 'Loading...'}}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
            <div class="summary-info">
                <div>
                <span class="blue-light" *ngIf="isNotActive()">
                    <mat-icon fontSet="fa" fontIcon="fa-times-circle"></mat-icon>&nbsp;Non Attivo
                </span>

                        <span class="green-light" *ngIf="isValid()">
                    <mat-icon fontSet="fa" fontIcon="fa-check-circle"></mat-icon>&nbsp;Attivo
                </span>
                        <span class="red-light" *ngIf="isExpired()">
                    <mat-icon fontSet="fa" fontIcon="fa-times-circle"></mat-icon>&nbsp;Scaduto
                </span>
                </div>
                <div>
                    <mat-icon fontSet="fas" fontIcon="fa-tag"></mat-icon>&nbsp;{{getBundleType()}}
                </div>
                <div *ngIf="!!bundle?.expiredAt">
                    <mat-icon fontSet="fa" fontIcon="fa-calendar-times"></mat-icon>
                    Data scadenza&nbsp;&nbsp;{{bundle?.expiredAt | date: 'dd/MM/yyyy'}}
                </div>
                <ng-container [ngSwitch]="bundle?.type">

                    <ng-container *ngSwitchCase="PERSONAL">
                        <div>
                            <mat-icon fontSet="fa" fontIcon="fa-running"></mat-icon> {{bundle?.sessions.length}}/{{bundle?.bundleSpec.numSessions}} Sessioni
                        </div>
                    </ng-container>
                    <ng-container *ngSwitchCase="COURSE">
                        <ng-container *ngIf="!!bundle?.startTime">
                            <div>
                                <mat-icon fontSet="fas" fontIcon="fa-hourglass-start"></mat-icon>
                                Data di inizio&nbsp;&nbsp;{{bundle?.startTime| date: 'dd/MM/yyyy'}}
                            </div>
                            <div>
                                <mat-icon fontSet="fa" fontIcon="fa-hourglass-end"></mat-icon>
                                Data di fine&nbsp;&nbsp;{{bundle?.endTime| date: 'dd/MM/yyyy'}}
                            </div>
                            <div>
                                <mat-icon fontSet="fas" fontIcon="fa-users"></mat-icon>Massimo numero di clienti&nbsp;{{bundle?.bundleSpec.maxCustomers}}
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>
            </div>
            <mat-expansion-panel class='expansion-list'
                                 [class.mat-expansion-panel]="false"
                                 *ngIf="bundle?.sessions.length > 0">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <h6>Sessioni</h6>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <table mat-table style="width: 100%" [dataSource]="bundle?.sessions">

                    <ng-container matColumnDef="index">
                        <th mat-header-cell *matHeaderCellDef> No. </th>
                        <td mat-cell *matCellDef="let element; let i = index"> {{i+1}} </td>
                    </ng-container>

                    <ng-container matColumnDef="date">
                        <th mat-header-cell *matHeaderCellDef> Data </th>
                        <td mat-cell *matCellDef="let element"> {{element.startTime | date: 'dd/MM/yyyy'}} </td>
                    </ng-container>

                    <ng-container matColumnDef="startTime">
                        <th mat-header-cell *matHeaderCellDef> Inizio </th>
                        <td mat-cell *matCellDef="let element"> {{element.startTime | date: 'HH:mm'}} </td>
                    </ng-container>


                    <ng-container matColumnDef="endTime">
                        <th mat-header-cell *matHeaderCellDef> Fine </th>
                        <td mat-cell *matCellDef="let element"> {{element.endTime | date: 'HH:mm'}} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedSessionsColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedSessionsColumns; let i = index;"></tr>
                </table>
            </mat-expansion-panel>
        </mat-card-content>
        <mat-card-actions>
            <button mat-button color="primary" (click)="goToBundleSPec()">
                <span>
                    <mat-icon fontSet="fas" fontIcon="fa-info"></mat-icon>&nbsp;Tipo Pacchetto
                </span>
            </button>
            <button *ngIf="canEdit" mat-button (click)="edit()">
                <span>
                    <mat-icon fontSet="fas" fontIcon="fa-edit"></mat-icon>&nbsp;Attiva
                </span>
            </button>
            <button *ngIf="canDelete" mat-button color="warn" (click)="delete()">
            <span>
                <mat-icon fontSet="fas" fontIcon="fa-trash"></mat-icon>&nbsp;Elimina
            </span>
            </button>
        </mat-card-actions>
    </mat-card>
</div>
